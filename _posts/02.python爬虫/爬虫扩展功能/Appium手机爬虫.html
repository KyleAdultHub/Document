---
title: Appium手机爬虫
date: "2017-02-10 23:00:00"
categories:
- python爬虫
- 爬虫扩展功能
tags:
- 爬虫
toc: true
typora-root-url: ..\..\..
---


<html>
<body>
<div>
<span><div><div><font style="background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-size: 14pt;-evernote-highlight:true;"><b>Appium的介绍和安装</b></font></div><ul><li><div><font style="font-size: 12pt;"><b>Appium的简介</b></font></div></li><ul><li><div><font style="font-size: 9pt;">Appium是移动端的自动化测试工具，类似于前面所说的Selenium，利用它可以驱动Android、iOS等设备完成自动化测试，比如模拟点击、滑动、输入等操作</font></div></li><li><div><font style="font-size: 9pt;">Appium负责驱动移动端来完成一系列操作，对于iOS设备来说，它使用苹果的UIAutomation来实现驱动；对于Android来说，它使用UIAutomator和Selendroid来实现驱动。</font></div></li><li><div><font style="font-size: 9pt;">同时Appium也相当于一个服务器，我们可以向它发送一些操作指令，它会根据不同的指令对移动设备进行驱动，以完成不同的动作。</font></div></li></ul><li><div><font style="font-size: 12pt;"><b>Appium相关链接</b></font></div></li><ul><li><div><font style="font-size: 9pt;">GitHub：https://github.com/appium/appium</font></div></li><li><div><font style="font-size: 9pt;">官方网站：http://appium.io</font></div></li><li><div><font style="font-size: 9pt;">官方文档：http://appium.io/introduction.html</font></div></li><li><div><font style="font-size: 9pt;">下载链接：https://github.com/appium/appium-desktop/releases</font></div></li><li><div><font style="font-size: 9pt;">Python Client：https://github.com/appium/python-client</font></div></li><li><div><font style="font-size: 9pt;">Appium Api：https://testerhome.comm/topics/3711</font></div></li></ul><li><div><font style="font-size: 12pt;"><b>Appium的安装</b></font></div></li><ul><li><div><font style="font-size: 9pt;"><b>通过Appium Desktop安装</b></font></div></li><ul><li><div><font style="font-size: 9pt;">Appium Desktop介绍</font></div></li><ul><li><div><font style="font-size: 9pt;">Appium Desktop支持全平台的安装，我们直接从GitHub的Releases里面安装即可</font></div></li><li><div><font style="font-size: 9pt;">链接为https://github.com/appium/appium-desktop/releases。目前的最新版本</font></div></li></ul><li><div><font style="font-size: 9pt;">各平台的安装方法</font></div></li></ul></ul></ul><ul><ul><ul><li><div><font style="font-size: 9pt;">下载exe安装包appium-desktop-Setup-1.1.0.exe</font></div></li><li><div><font style="font-size: 9pt;">Mac平台可以下载dmg安装包如appium-desktop-1.1.0.dmg</font></div></li><li><div><font style="font-size: 9pt;">Linux平台可以选择下载源码</font></div></li></ul><li><div><font style="font-size: 9pt;"><b>通过Node.js安装</b></font></div></li><ul><li><div><font style="font-size: 9pt;">1.首先安装node.js</font></div></li><li><div><font style="font-size: 9pt;">2.npm install -g appium</font></div></li></ul><li><div><font style="font-size: 9pt;"><b>python-api安装</b></font></div></li><ul><li><div><font style="font-size: 9pt;">pip install Appium-Python-Client</font></div></li></ul></ul><li><div><font style="font-size: 12pt;"><b>开发环境的配置</b></font></div></li><ul><li><div><font style="font-size: 9pt;"><b>Android开发环境配置</b></font></div></li><ul><li><div><font style="font-size: 9pt;">下载和配置Android Studio，下载地址为https://developer.android.com/studio/index.html?hl=zh-cn。下载后直接安装即可。</font></div></li><li><div><font style="font-size: 9pt;">打开Android Studio，直接打开首选项里面的Android SDK设置页面，勾选要安装的SDK版本，点击OK按钮即可下载和安装勾选的SDK版本。</font></div></li><li><div><font style="font-size: 9pt;">添加环境变量，添加ANDROID_HOME为Android SDK所在路径，然后再添加SDK文件夹下的tools和platform-tools文件夹到PATH中。</font></div></li><li><div><font style="font-size: 9pt;">更详细的配置可以参考Android Studio的官方文档：https://developer.android.com/studio/intro/index.html。</font></div></li></ul></ul></ul><div><font style="color: rgb(50, 135, 18); font-size: 14pt;"><b style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Appium的使用(有界面版示例)</b></font></div><ul><li><div><font style="font-size: 12pt;"><b>启动Appium服务</b></font></div></li><ul><li><div><font style="font-size: 9pt;">点击Appium</font></div></li><li><div><font style="font-size: 9pt;">输入主机和端口号，点击Start Server按钮即可启动Appium服务</font></div></li></ul><li><div><font style="font-size: 12pt;"><b>将手机连接到PC端</b></font></div></li><ul><li><div><font style="font-size: 9pt;">将手机通过数据线和PC相连</font></div></li><li><div><font style="font-size: 9pt;">打开USB调试功能，确保PC可以连接到手机</font></div></li><li><div><font style="font-size: 9pt;">可以在PC端测试是否连接成功</font></div></li><ul><li><div><font style="font-size: 9pt;">adb  devices  -l   查看连接的设备列表</font></div></li><ul><li><div><font style="font-size: 9pt;">如果找不到adb命令，请检查Android开发环境和环境变量是否配置成功</font></div></li><li><div><font style="font-size: 9pt;">如果adb命令不显示设备信息，检查手机和PC的连接情况</font></div></li></ul></ul></ul><li><div><font style="font-size: 12pt;"><b>启动App并操作</b></font></div></li><ul><li><div><font style="font-size: 10pt;"><b>通过Appium内置驱动来操作</b></font></div></li><ul><li><div><font style="font-size: 9pt;"><b>打开app</b></font></div></li></ul></ul></ul><ul><ul><ul><li><div><font style="font-size: 9pt;">点击Appium中的Start New Session</font></div></li><li><div><font style="font-size: 9pt;">配置启动App时的参数</font></div></li><ul><li><div><font style="font-size: 9pt;">platformName: 它是平台名称，需要区分Android或iOs，此处填Android</font></div></li><li><div><font style="font-size: 9pt;">deviceName: 它是设备名称， 此处是手机的具体类型</font></div></li><li><div><font style="font-size: 9pt;">appPackage： 它是App程序的包名</font></div></li><li><div><font style="font-size: 9pt;">AppActivity: 它是入口Activity名，这里通常需要.开头</font></div></li></ul><li><div><font style="font-size: 9pt;">点击保存按钮，可以将此配置进行保存</font></div></li><li><div><font style="font-size: 9pt;">点击Start Session，便会启动Android手机上的App，同时PC上会弹出一个调试窗口，里面包含了页面源码</font></div></li></ul><li><div><font style="font-size: 9pt;"><b>操作应用App</b></font></div></li><ul><li><div><font style="font-size: 9pt;">选择元素</font></div></li><ul><li><div><font style="font-size: 9pt;">和浏览器的调试一样，只要点击作业页面中的元素，对应的元素就会高亮，中间栏会显示对应的源码</font></div></li><li><div><font style="font-size: 9pt;">右侧是和元素包含的属性和事件等信息</font></div></li></ul><li><div><font style="font-size: 9pt;">操作元素</font></div></li><ul><li><div><font style="font-size: 9pt;">点击右侧元素的属性，便可以实现对元素的操作</font></div></li></ul><li><div><font style="font-size: 9pt;">操作的录制</font></div></li><ul><li><div><font style="font-size: 9pt;">点击中间栏的眼睛按钮，Appium会开始录制操作的动作，这时我们可以在窗口中操作APp的行为都会记录下来</font></div></li><li><div><font style="font-size: 9pt;">Recorder处可以自动生成对应的语言代码。</font></div></li></ul><li><div><font style="font-size: 9pt;"><img src="/e_img/Appium手机爬虫_files/Image.png" type="image/png" data-filename="Image.png" width="804"/></font></div></li></ul></ul><li><div><font style="font-size: 10pt;"><b>通过Python代码来操作</b></font></div></li><ul><li><div><font style="font-size: 9pt;"><b>打开app(初始化应用)</b></font></div></li><ul><li><div><font style="font-size: 9pt;">打开方法</font></div></li><ul><li><div><font style="font-size: 9pt;">用字典来配置Desired Capabilities 参数，新建一个Session</font></div></li></ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">server = &quot;http://localhost:4723/wd/hub&quot;</font></div></li><li><div><font style="font-size: 9pt;">desired_caps = {</font></div></li><ul><li><div><font style="font-size: 9pt;">&quot;platformName&quot;: &quot;Android&quot;,</font></div></li><li><div><font style="font-size: 9pt;">&quot;deviceName&quot;: &quot;MI_NOTE_Pro&quot;,</font></div></li><li><div><font style="font-size: 9pt;">&quot;appPackage&quot;: &quot;com.tencent.mm&quot;,</font></div></li><li><div><font style="font-size: 9pt;">&quot;appActivity&quot;: &quot;.ui.LauncherUI&quot;</font></div></li></ul><li><div><font style="font-size: 9pt;">}</font></div></li><li><div><font style="font-size: 9pt;">from appium import Webdriver</font></div></li><li><div><font style="font-size: 9pt;">from selenium.webdriver.support.ui import WebDriverWait</font></div></li><li><div><font style="font-size: 9pt;">driver = wevdriver.Remote(server, desired_caps)    # 启动app</font></div></li></ul></ul><li><div><font style="font-size: 9pt;"><b>查找元素</b></font></div></li><ul><li><div><font style="font-size: 9pt;">element = driver.find_element_by_android_uiautomator('new UiSelector().description(&quot;Animation&quot;)')</font></div></li><li><div><font style="font-size: 9pt;">elements = driver.find_elements_by_android_uiautomator('new UiSelector().description(&quot;Animation&quot;)')</font></div></li></ul><li><div><font style="font-size: 9pt;"><b> 点击操作</b></font></div></li><ul><li><div><font style="font-size: 9pt;">多点点击方法</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.tap(self, positions, duration=None)</font></div></li><ul><li><div><font style="font-size: 9pt;">positions: 它是点击的位置组成的列表</font></div></li><li><div><font style="font-size: 9pt;">duration: 它是点击持续的时间</font></div></li><li><div><font style="font-size: 9pt;">通过tap方法实现触摸点击</font></div></li><li><div><font style="font-size: 9pt;">该方法可以模拟手指点击，最多五个手指，也可以设置触摸的时间长短</font></div></li></ul></ul><li><div><font style="font-size: 9pt;">单点点击方法</font></div></li><ul><li><div><font style="font-size: 9pt;">element.click()    对元素进行点击</font></div></li></ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.tap([(100, 20), (100, 60), (100, 100)], 500)</font></div></li></ul></ul><li><div><font style="font-size: 9pt;"><b>屏幕拖动</b></font></div></li><ul><li><div><font style="font-size: 9pt;">元素间拖动方法</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.scroll(self, origin_el, destination_el)</font></div></li><ul><li><div><font style="font-size: 9pt;">original_el: 拖动的起始元素</font></div></li><li><div><font style="font-size: 9pt;">destination_el:拖动的终止元素</font></div></li></ul></ul><li><div><font style="font-size: 9pt;">两点间的拖动方法</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.swipe(self, start_x, start_y, end_x, end_y, duration=None)</font></div></li><ul><li><div><font style="font-size: 9pt;">start_x: 它是开始位置的横坐标</font></div></li><li><div><font style="font-size: 9pt;">start_y: 它是开始位置的纵坐标</font></div></li><li><div><font style="font-size: 9pt;">end_x: 它是终止位置的横坐标</font></div></li><li><div><font style="font-size: 9pt;">end_y: 它是终止位置的纵坐标</font></div></li><li><div><font style="font-size: 9pt;">duration: 它是持续时间，单位是毫秒</font></div></li></ul></ul><li><div><font style="font-size: 9pt;">两点间的快速的滑动</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.swipe()</font></div></li><ul><li><div><font style="font-size: 9pt;">start_x: 它是开始位置的横坐标</font></div></li><li><div><font style="font-size: 9pt;">start_y: 它是开始位置的纵坐标</font></div></li><li><div><font style="font-size: 9pt;">end_x: 它是终止位置的横坐标</font></div></li><li><div><font style="font-size: 9pt;">end_y: 它是终止位置的纵坐标</font></div></li></ul></ul></ul></ul></ul><ul><ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.scroll(el1, el2)</font></div></li><li><div><font style="font-size: 9pt;">driver.swipe(100, 100, 100, 400, 5000)</font></div></li><li><div><font style="font-size: 9pt;">driver.flick(100, 100, 100, 400)</font></div></li></ul></ul><li><div><font style="font-size: 9pt;"><b>元素的拖拽</b></font></div></li><ul><li><div><font style="font-size: 9pt;">拖拽方法</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.drag_and_drop(self, origin_el, destination_el)</font></div></li><ul><li><div><font style="font-size: 9pt;">origin_el: 被拖拽的元素</font></div></li><li><div><font style="font-size: 9pt;">destination_el：拖拽的目标元素</font></div></li></ul></ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">driver.drag_and_drop(el1, el2)</font></div></li></ul></ul><li><div><font style="font-size: 9pt;"><b>文本的输入</b></font></div></li><ul><li><div><font style="font-size: 9pt;">输入的方法</font></div></li><ul><li><div><font style="font-size: 9pt;">ele.set_text('Hello')</font></div></li></ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">element = driver.find_element_by_id('name')</font></div></li><li><div><font style="font-size: 9pt;">element.set_text(&quot;Hello&quot;)</font></div></li></ul></ul><li><div><font style="font-size: 9pt;"><b>动作链</b></font></div></li><ul><li><div><font style="font-size: 9pt;">使用动作链的方法</font></div></li><ul><li><div><font style="font-size: 9pt;">from appium import TouchAction()</font></div></li><li><div><font style="font-size: 9pt;">action = TouchAction()</font></div></li><li><div><font style="font-size: 9pt;">action.tap(element).perfoem()</font></div></li><li><div><font style="font-size: 9pt;">常用的动作链还有: tap、press、long_press、release、move_to、wait、cancel</font></div></li></ul><li><div><font style="font-size: 9pt;">示例代码</font></div></li><ul><li><div><font style="font-size: 9pt;">from appium import TouchAction()</font></div></li><li><div><font style="font-size: 9pt;">action = TouchAction()</font></div></li><li><div><font style="font-size: 9pt;">a_ele = self.driver.find_element_by_class_name(&quot;listView&quot;)</font></div></li><li><div><font style="font-size: 9pt;">action.press(a_ele).move_to(x=10, y=0), move_to(x=10, y=-600).release()</font></div></li><li><div><font style="font-size: 9pt;">action.perform</font></div></li></ul></ul></ul></li></ul><div><br/></div></div></span>
</div></body></html>