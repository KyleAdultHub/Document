---
title: 数据快速写入Csv文件
date: "2017-02-05 23:00:00"
categories:
- python爬虫
- 爬虫扩展功能
tags:
- 爬虫
toc: true
typora-root-url: ..\..\..
---

<html>
<body>
<div>
<span><div><div><div><font style="color: rgb(50, 135, 18); font-size: 14pt;"><b style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">csv文件的写入</b></font></div><ul><li><div><font style="font-size: 10pt;"><b>以列表的方式写入</b></font></div></li><ul><li><div><font style="font-size: 9pt;">import  csv      导入csv模块</font></div></li><li><div><font style="font-size: 9pt;">with open('data.csv', 'w', encoding='utf-8') as csvfile:</font></div></li><ul><li><div><font style="font-size: 9pt;">writer = csv.writer(csvfile, delimiter=',')    创建阅读器</font></div></li><li><div><font style="font-size: 9pt;">writer.writerow(['id', 'name', 'age'])    向csv文件中写入一行数据</font></div></li><li><div><font style="font-size: 9pt;">writer.writerows([ ['1', '2', '3'], ['2', '3', '4'] ])     向csv文件中写入多行数据</font></div></li></ul></ul><li><div><font style="font-size: 10pt;"><b>以字典的方式写入</b></font></div></li><ul><li><div><font style="font-size: 9pt;">import  csv      导入csv模块</font></div></li><li><div><font style="font-size: 9pt;">with open('data.csv', 'w', encoding='utf-8') as csvfile:</font></div></li><li><div><font style="font-size: 9pt;">fieldnames = ['id', 'name', 'age']</font></div></li><ul><li><div><font style="font-size: 9pt;">writer = csv.DictWriter(csvfile, fieldnames=fieldnames)    创建阅读器， 并指定列索引</font></div></li><li><div><font style="font-size: 9pt;">writer.writeheader()      向文件中写入列的索引</font></div></li><li><div><font style="font-size: 9pt;">writer.writerow({'id': 1, 'name': 2, 'age': 3})    向csv文件中写入一行数据</font></div></li></ul></ul></ul><div><font style="font-size: 14pt; color: rgb(50, 135, 18);"><b style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">csv文件的读取</b></font></div><ul><li><div><b><font style="font-size: 10pt;">csv文件按行读取</font></b></div></li><ul><li><div><font style="font-size: 9pt;">import csv</font></div></li><li><div><font style="font-size: 9pt;">with open('data.csv', 'r', encoding='utf-8') as csvfile:</font></div></li><ul><li><div><font style="font-size: 9pt;">reader = csv.reader(csvfile)      创建阅读器</font></div></li><li><div><font style="font-size: 9pt;">for row in reader:</font></div></li><ul><li><div><font style="font-size: 9pt;">print(row)</font></div></li></ul></ul><li><div><font style="font-size: 9pt;">&gt;&gt; ['id', 'name', 'age']</font></div></li></ul></ul><div><font style="background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-size: 14pt;-evernote-highlight:true;"><b>使用pandas进行csv文件的写入和读取</b></font></div></div><ul><li><div><span style="font-weight: bold; line-height: 13.6px;"><font style="font-size: 10pt;">读取csv文件数据的方法</font></span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="line-height: 13.6px;">df_obj = pd.read_csv('filename', [</span><span style="line-height: 13.6px;">usecols=['col1', 'col2'], skiprows=n1, skipfooter=n2, index_col=n3, engine='python'</span><span style="line-height: 13.6px;">])     返回的是DataFrame对象</span></font></div></li><ul><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">filename：表示读取的文件名</font></span></div></li><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">usecols：表示读取文件的哪些列</font></span></div></li><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">skiprows:  表示跳过文件的前几行</font></span></div></li><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">skipfooter： 表示跳过文件的后几行</font></span></div></li><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">index_col：表示使用那一列作为索引列</font></span></div></li><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">engine： 使用的解释器引擎， 当读取中文文件的时候需要指定</font></span></div></li></ul></ul><li><div><span style="font-weight: bold; line-height: 13.6px;"><font style="font-size: 10pt;">写入csv数据的方法</font></span></div></li><ul><li><div><font style="font-size: 9pt;">df_obj.to_csv(&quot;filename&quot;)</font></div></li><ul><li><div><span style="line-height: 13.6px;"><font style="font-size: 9pt;">filename：表示读取的文件名,要加上.csv后缀；</font></span></div></li></ul></ul></ul><div><br/></div></div><div><br/></div></span>
</div></body></html>