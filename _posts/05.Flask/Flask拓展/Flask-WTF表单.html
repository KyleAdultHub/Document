---
title: Django-Model
date: "2017-08-01 22:00:00"
categories:
- Flask
- Flask拓展
tags:
- Flask
toc: true
---

<html>
<head>
  <title>Flask-WTF表单</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/307941 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="523"/>
<h1>Flask-WTF表单</h1>

<div>
<span><div><div><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Web表单与Flask-WTF拓展</span></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">web表单</span></font></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">它是HTML页面中负责数据采集的部件。表单有三个部分组成：表单标签、表单域、表单按钮。表单允许用户输入数据，负责HTML页面数据采集，通过表单将用户输入的数据提交给服务器。</span></li></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">Flask-WTF拓展</span></font></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">Flask-WTF是一个Html表单的拓展，可以使用python代码写表单，然后传递到模板中渲染</span></li><li><span style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">Flask-WTF扩展<span style="font-size: 9pt; line-height: 1.45;">封装了WTForms，<span style="font-size: 9pt; line-height: 1.45;">有验证表单数据的功能；</span></span></span></span></li></ul></ul><div><span style="font-size: 18.399999618530273px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 18.399999618530273px; color: rgb(50, 135, 18); font-weight: bold; line-height: 13.600000381469727px;-evernote-highlight:true;">FORM表单提交的实现</span></span></div></div><ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">通过HTML页面实现表单提交和验证</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">在HTML中实现表单页面</span></font></li><ul><li><span style="font-size: 9pt;"><img src="Flask-WTF表单_files/Image.png" type="image/png" data-filename="Image.png" width="362"/></span></li></ul><li><font style="font-size: 12px;"><span style="font-size: 12px; font-weight: bold; line-height: 13.600000381469727px;">定义路由和视图函数，接收表单提交的数据进行验证</span></font></li><ul><li><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.600000381469727px;">GET请求获取表单，POST请求提交表单</span></font></li><li><img src="Flask-WTF表单_files/Image [1].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="338"/></li></ul></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">通过Flask-WTF实现表单的提交和验证</span></font></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">导入FlaskForm表单、标准字段、calidators验证器</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">from flask-wtf import FlaskForm</span></li><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">from wtforms import  标准字段</span></font></li><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">from wtforms.validators import 验证器</span></font></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">所有的标准字段和验证器示例：</span></li><ul><li><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.600000381469727px;">标准字段</span></font></li><ul><li><img src="Flask-WTF表单_files/Image [2].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="328"/></li></ul><li><span style="font-size: 9pt; line-height: 1.45;">WTForms常用验证器</span></li><ul><li><img src="Flask-WTF表单_files/Image [3].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="312"/></li></ul></ul></ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">设置SECRET_KEY</span></font></li><ul><li><span style="font-size: 9pt;">因为FlaskForm会自动的进行csrf的验证，生成csrf密文会使用到SECRET_KEY</span></li><li><span style="font-size: 9pt;">过程中会使用的用flash() 记录表单验证错误信息，flash会用到session，所以会用到SECRET_KEY</span></li><ul><li><span style="font-size: 9pt;">app.secret_key = &quot;liukaijian&quot;</span></li></ul></ul><li><span style="font-size: 9pt; font-weight: bold;">自定义表单类</span></li><ul><li><img src="Flask-WTF表单_files/Image [4].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="704"/></li></ul><li><span style="font-size: 12px; font-weight: bold; line-height: 13.600000381469727px;">定义路由和视图函数</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">G<span style="font-size: 9pt; line-height: 13.600000381469727px;">ET请求：创建表单实例，将其传递给HTMl模板进行渲染</span></span></font></li><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">POST请求：创建表单实例，FlaskForm实例会对表单的提交结果进行验证，如果验证通过，返回成功内容</span></font></li><li><img src="Flask-WTF表单_files/Image [5].png" type="image/png" data-filename="Image.png" width="530"/></li></ul><li><span style="font-weight: bold; line-height: 13.600000381469727px;">定义HTMl页面</span></li><ul><li><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.600000381469727px;">接收视图函数传递过来的表单对象，并获取其属性将其渲染到标签中</span></font></li><li><span style="font-size: 9pt;">因为FlaskForm会自动的进行csrf的验证，所以我们要设置一个csrf_token标签</span></li><li><img src="Flask-WTF表单_files/Image [6].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-size: 9pt;" width="330"/></li></ul></ul></ul><div><br/></div></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-weight: bold; color: rgb(50, 135, 18); font-size: 14pt;-evernote-highlight:true;">csrf_token 验证的设置</span></span></div><div><ul><li><font style="font-size: 10pt;"><span style="line-height: 13.600000381469727px;"><b>csrf_token设置</b></span></font></li><ul><li>1.<img src="Flask-WTF表单_files/Image [7].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="275"/></li><li><span style="font-size: 9pt;">2.要首先配置SECRET_KEY</span></li><li><span style="font-size: 9pt;">3.在创建了表单类的时候，是默认配置了csrf_token的，但是在未使用表单类的时候，需要手动开启csrf验证</span></li></ul><li><font style="font-size: 10pt;"><span style="line-height: 13.600000381469727px;"><b>csrf_token验证</b></span></font></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">在响应在中给cookie添加csrf_token  (在使用表单的时候默认添加，不使用表单手动添加)</font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">生成csrf_token</font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">from flask_wtf.csrf import generate_csrf</font></span></li><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">token = generate_csrf()</font></span></li><li><font style="font-size: 9pt;"><span style="line-height: 13.600000381469727px;">response.set_cookie('csrf_token', token)</span></font></li></ul><li><font style="font-size: 9pt;"><span style="line-height: 13.600000381469727px;">在前端的请求给headers添加csrf_token参数</span></font></li></ul></ul></ul></div><div><br/></div></span>
</div></body></html> 