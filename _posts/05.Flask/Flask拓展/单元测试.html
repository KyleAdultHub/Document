---
title: 单元测试
date: "2017-08-10 22:00:00"
categories:
- Flask
- Flask拓展
tags:
- Flask
toc: true
---

<html>
<body>
<div>
<span><div><font style="font-size: 16pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18);-evernote-highlight:true;"><b>单元测试概念</b></font></div><div><ul><li><b><font style="font-size: 10pt;">为什么需要单元测试</font></b></li><ul><li><span style="font-size: 9pt;">Web程序开发过程一般包括以下几个阶段：[需求分析，设计阶段，实现阶段，测试阶段]。其中测试阶段通过人工或自动来运行测试某个系统的功能。</span></li><li><span style="font-size: 9pt;">目的是检验其是否满足需求，并得出特定的结果，以达到弄清楚预期结果和实际结果之间的差别的最终目的</span></li></ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">测试的分类</font></b></span></li><ul><li><span style="font-size: 9pt;">单元测试（与开发人员相关）</span></li><ul><li><span style="font-size: 9pt;">对单独的代码块(例如函数)分别进行测试,以保证它们的正确性</span></li></ul><li><span style="font-size: 9pt;">集成测试</span></li><ul><li><span style="font-size: 9pt;">对大量的程序单元的协同工作情况做测试</span></li></ul><li><span style="font-size: 9pt;">系统测试</span></li><ul><li><span style="font-size: 9pt;">同时对整个系统的正确性进行检查,而不是针对独立的片段</span></li></ul></ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">什么是单元测试</font></b></span></li><ul><li><span style="font-size: 9pt;">当我们的某些功能代码完成后，为了检验其是否满足程序的需求。可以通过编写测试代码，模拟程序运行的过程，检验功能代码是否符合预期。</span></li><li><span style="font-size: 9pt;">单元测试就是开发者编写一小段代码，检验目标代码的功能是否符合预期。通常情况下，单元测试主要面向一些功能单一的模块进行。</span></li><li><span style="font-size: 9pt;">在Web开发过程中，单元测试实际上就是一些“断言”（assert）代码，判断执行结果是否符合预期</span></li></ul></ul></div><div><div><span style="line-height: 13.600000381469727px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><b><font style="font-size: 14pt; color: rgb(50, 135, 18);">单元测试步骤</font></b></span></div><div><ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">先定义一个类，继承自unittest.TestCase</font></b></span></li><ul><li><span style="line-height: 13.600000381469727px; font-size: 9pt;">import unittest</span></li><li><span style="line-height: 13.600000381469727px; font-size: 9pt;">class TestClass(unitest.TestCase): </span></li><ul><li><font size="2"><span style="line-height: 13.600000381469727px;">...</span></font></li></ul></ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">在测试类中定义两个方法</font></b></span></li><ul><li><span style="line-height: 1.45;"><b><font style="font-size: 9pt;">setUp测试案例启动前调用，可以设置初始化代码</font></b></span></li><ul><li><font style="font-size: 9pt;"><span style="line-height: 1.45;">def</span> <span style="line-height: 1.45;">setUp</span><span style="line-height: 1.45;">(self)</span><span style="line-height: 1.45;">:</span></font></li><ul><li><font style="font-size: 9pt;">client = app.test_client()     获取flask中对应的测试客户端对象，通过它模拟发送请求</font></li><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">app.testing = True  设置app为测试模式，异常会定位到内测试代码导致异常的代码</font></span></li><li><font style="font-size: 9pt;">pass</font></li></ul></ul><li><font style="font-size: 9pt;"><b>tearDown所有测试案列完成之后调用，可以用来关闭上下文管理器等</b></font></li><ul><li><font style="font-size: 9pt;"><span style="line-height: 1.45;">def</span> <span style="line-height: 1.45;">tearDown</span><span style="line-height: 1.45;">(self)</span><span style="line-height: 1.45;">:</span></font></li><ul><li><span style="line-height: 1.45;"><font style="font-size: 9pt;">...</font></span></li></ul></ul></ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">在测试类中，编写测试代码</font></b></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">from  main import app    </font></span></li><li><font size="2"><span style="line-height: 13.600000381469727px;">import json</span></font></li><ul><li><font style="font-size: 9pt;">def test_function(self):    注意测试的方法一定要以test开头，才能被识别</font></li><ul><li><font style="font-size: 9pt;">self.client.post('/login', data={ })    通过测试客户端发起post请求，传入数据，获取响应</font></li><li><font style="font-size: 9pt;">response_data = response.data  获取响应中响应体的数据，字符串类型数据</font></li><li><font size="2"><span style="line-height: 13.600000381469727px;">resp_dict = json.loads(resp_data)    将字符串转换成字典</span></font></li></ul></ul></ul></ul><div><ul><ul><li><font style="font-size: 12px;"><span style="line-height: 13.600000381469727px;">self.assert 。。。。。。     再通过获取的值进行assert断言</span></font></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 10pt;"><b>运行测试代码</b></font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;"><b>第一种方法</b></font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">直接右键运行</font></span></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;"><b>第二种方法</b></font></span></li><ul><li><font style="font-size: 9pt;"><span style="line-height: 13.600000381469727px;">unittest.main()    通过调用main方法来启动测试代码</span></font></li></ul></ul></ul><div><font style="color: rgb(50, 135, 18); font-size: 14pt;"><span style="line-height: 13.600000381469727px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><b>登录测试</b></span></font></div></div><div><ul><li><img src="/e_img/e_img/单元测试_files/Image.png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="555"/></li></ul></div><div><span style="line-height: 13.600000381469727px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><b><font style="font-size: 14pt; color: rgb(50, 135, 18);">数据库测试</font></b></span></div><div><ul><li><img src="/e_img/e_img/单元测试_files/Image [1].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="550"/></li></ul><div><br/></div></div></div><div style="font-size: 9pt;"></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); line-height: 13.600000381469727px; font-weight: bold; color: rgb(50, 135, 18); font-size: 14pt;-evernote-highlight:true;">程序断言的使用（assert）</span></span></div><ul><li><span style="line-height: 13.600000381469727px;"><b><font style="font-size: 10pt;">程序断言的作用</font></b></span></li><ul><li><span style="font-size: 9pt;">断言就是判断一个函数或对象的一个方法所产生的结果是否符合你期望的那个结果。</span></li><li><font style="font-size: 9pt;">python中assert断言是声明布尔值为真的判定，如果表达式为假会抛出异常。</font></li><li><font style="font-size: 9pt;">单元测试中，一般使用assert来断言结果。</font></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 10pt;"><b>程序断言的使用示例</b></font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">assert isinstance(num1, int)    断言num1是一个int类型，不是的话抛出异常</font></span></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 10pt;"><b>常用的断言方法</b></font></span></li><ul><li><font style="font-size: 12px;"><span style="line-height: 13.600000381469727px;"><b>系统自带断言</b></span></font></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">assert 后面的布尔表达式为True，则pass</font></span></li></ul><li><span style="line-height: 13.600000381469727px; font-size: 9pt;"><b>unitest.TestCase封装的断言，通过self.assert来调用</b></span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">assertEqual 如果两个值相等，则pass</span></li><li><span style="font-size: 9pt; line-height: 1.45;">assertNotEqual 如果两个值不相等，则pass</span></li><li><span style="font-size: 9pt; line-height: 1.45;">assertTrue 判断bool值为True，则pass</span></li><li><span style="font-size: 9pt; line-height: 1.45;">assertFalse 判断bool值为False，则pass</span></li><li><span style="font-size: 9pt; line-height: 1.45;">assertIsNone 不存在，则pass</span></li><li><span style="font-size: 9pt; line-height: 1.45;">assertIsNotNone 存在，则pass</span></li></ul></ul></ul></div><div><br/></div></span>
</div></body></html>