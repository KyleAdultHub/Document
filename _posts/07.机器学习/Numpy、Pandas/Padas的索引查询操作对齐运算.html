---
title: Pandas的索引查询操作与对其运算
date: "2017-05-23 22:00:00"
categories:
- 机器学习
- Numpy、Pandas
tags:
- 数据处理
- pandas
toc: true
typora-root-url: ..\..\..
---

<html>
<body>
<div>
<span><div><font style="font-size: 14pt;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">索引对象Index介绍</span></font></div><div><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">索引的介绍</span></font></div></li><ul><li><div><span style="font-size: 9pt;">Series和DataFrame中的索引都是Index对象</span></div></li></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">索引对象的代码示例</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image.png" type="image/png" data-filename="Image.png" width="241"/></span></div></li></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">索引对象的性质</span></font></div></li><ul><li><div><span style="font-size: 9pt;">索引对象不可变，保证了数据的安全性（下面尝试对索引进行修改，会报错）</span></div></li><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [1].png" type="image/png" data-filename="Image.png" width="428"/></span></div></li></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">常见的Index种类</span></font></div></li><ul><li><div><span style="font-size: 9pt;">Index  索引</span></div></li><li><div><span style="font-size: 9pt;">Int64Index    整数索引</span></div></li><li><div><span style="font-size: 9pt;">MultiIndex     层级索引</span></div></li><li><div><span style="font-size: 9pt;">DatetimeIndex    时间戳索引</span></div></li></ul></ul><div><font style="font-size: 14pt;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Pandas数据结构的常见索引操作</span></font></div></div><div><ul><li><div><span style="font-size: 10pt; font-weight: bold;">Series的索引查询操作</span></div></li><ul><li><div><span style="font-size: 9pt; font-weight: bold;">创建</span><span style="font-size: 9pt; font-weight: bold;">Series</span><span style="font-size: 9pt; font-weight: bold;">对象并指定Series行索引名</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [2].png" type="image/png" data-filename="Image.png" width="345"/></span></div></li></ul><li><div><span style="font-size: 9pt; font-weight: bold;">通过行索引获取行数据（通过索引名或索引下标）</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">通过索引名来取值</span></font></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj['name']</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">name: 为索引的名字</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">通过索引的下标来取值</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj[n]</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">n： 为索引的下标</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">示例</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [3].png" type="image/png" data-filename="Image.png" width="194"/></span></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">备注：如果索引名也是数字，那么按索引名进行取值</span></font></div></li></ul><li><div><span style="font-size: 9pt; font-weight: bold;">通过连续索引获取行数据（切片）</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [4].png" type="image/png" data-filename="Image.png" width="153"/></span></div></li></ul><li><div><span style="font-size: 9pt; font-weight: bold;">通过不连续索引获取行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [5].png" type="image/png" data-filename="Image.png" width="308"/></span></div></li></ul><li><div><span style="font-size: 9pt; font-weight: bold;">通过布尔索引获取行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [6].png" type="image/png" data-filename="Image.png" width="247"/> </span></div></li></ul></ul><li><div><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">DataFrame索引查询操作</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.6px;">创建</span><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">DataFrame对象并指定行\列索引</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [7].png" type="image/png" data-filename="Image.png" width="406"/></span></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">通过列索引获取列数据（通过索引名）  返回Series类型</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [8].png" type="image/png" data-filename="Image.png" width="202"/></span></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">通过不连续索引获取多列数据  返回DataFrame类型（不支持连续多列）</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [9].png" type="image/png" data-filename="Image.png" width="180"/></span></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">通过连续索引取所有列的多行数据（不支持不连续多行）</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [10].png" type="image/png" data-filename="Image.png" width="206"/></span></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">通过索引取多行多列数据</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [11].png" type="image/png" data-filename="Image.png" width="215"/></span></div></li></ul><li><div><span style="font-size: 9pt; font-weight: bold;">通过布尔索引获取行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [12].png" type="image/png" data-filename="Image.png" width="184"/></span></div></li><li><div><span style="font-size: 9pt;">不满足条件的返回Nan值</span></div></li></ul></ul><li><div><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">高级索引：标签、位置、混合</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">loc标签索引</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">介绍</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">DataFrame 不能直接列切片，可以通过loc来做切片</span></font></div></li><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">loc是基于标签名（索引名），也就是我们自定义的索引名来取值</span></font></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">Series对象取多行数据</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [13].png" type="image/png" data-filename="Image.png" width="189"/></span></div></li></ul><li><div><span style="font-size: 9pt;">DataFrame取值方法</span></div></li><ul><li><div><span style="font-size: 9pt;">取单行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [14].png" type="image/png" data-filename="Image.png" width="238"/></span></div></li><li><div><span style="font-size: 9pt;">备注:取单行数据的时候，会将不同列的数据类型进行转化为同一类型</span></div></li></ul><li><div><span style="font-size: 9pt;">取单列数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [15].png" type="image/png" data-filename="Image.png" width="162"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取单行单列数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [16].png" type="image/png" data-filename="Image.png" width="159"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取连续行的所有列数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [17].png" type="image/png" data-filename="Image.png" width="226"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取连续列的所有行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [18].png" type="image/png" data-filename="Image.png" width="187"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取连续的行和列</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [19].png" type="image/png" data-filename="Image.png" width="215"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取不连续的行</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [20].png" type="image/png" data-filename="Image.png" width="201"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取不连续的列</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [21].png" type="image/png" data-filename="Image.png" width="175"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取不连续的行和列</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [22].png" type="image/png" data-filename="Image.png" width="214"/></span></div></li></ul><li><div><span style="font-size: 9pt;">根据布尔条件取值</span></div></li><ul><li><div><span style="font-size: 9pt;">根据某一列的数据判断所有行的该列，返回符合条件的行</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [23].png" type="image/png" data-filename="Image.png" width="253"/></span></div></li></ul></ul></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">iloc位置索引</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">介绍</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">作用和loc一样，不过是基于索引编号（下标）来取索引值</span></font></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">Series对象取多行数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [24].png" type="image/png" data-filename="Image.png" width="134"/></span></div></li></ul><li><div><span style="font-size: 9pt;">DataFrame取值方法</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">取多行数据（取值下标不包含末位置）</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [25].png" type="image/png" data-filename="Image.png" width="218"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取连续多行多列数据<span style="font-size: 9pt; line-height: 13.6px;">（取值下标不包含末位置）</span></span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [26].png" type="image/png" data-filename="Image.png" width="166"/></span></div></li></ul><li><div><span style="font-size: 9pt;">取不连续多行多列数据</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [27].png" type="image/png" data-filename="Image.png" width="197"/></span></div></li></ul></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">ix标签与位置混合索引</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">介绍</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">ix是以上二者的综合，既可以使用索引编号（索引下标），又可以使用自定义索引（自定义索引名），要视情况不同来使用；</span></font></div></li><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">如果索引既有数字又有英文，那么这种方式是不建议使用的，容易导致定位的混乱。</span></font></div></li><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">由于经常会引起混淆，不推荐使用，上面两种方法，可以涵盖所有的需求</span></font></div></li></ul></ul></ul></ul><div><font style="font-size: 14pt;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Pandas的对齐运算</span></font></div></div><div><ul><li><div><span style="font-size: 10pt; font-weight: bold;">pandas对齐运算的介绍</span></div></li><ul><li><div><span style="font-size: 9pt;">是数据清洗的重要过程，可以按索引对齐进行运算，如果没对齐的位置则补NaN，最后也可以填充NaN</span></div></li></ul></ul><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><font style="font-size: 14pt;"><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold; line-height: 13.6px;-evernote-highlight:true;">Pandas的对其运算的操作</span></font></span></div></div><div><ul><li><div><span style="font-weight: bold; line-height: 13.6px;">常见的数据运算方法</span></div></li><ul><li><div><span style="font-size: 9pt;">add</span><span style="font-size: 9pt;">,</span><span style="font-size: 9pt;"> </span><span style="font-size: 9pt;">sub</span><span style="font-size: 9pt;">,</span><span style="font-size: 9pt;"> </span><span style="font-size: 9pt;">div</span><span style="font-size: 9pt;">,</span><span style="font-size: 9pt;"> </span><span style="font-size: 9pt;">mul</span></div></li></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">Series</span><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">数据间的对齐运算</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">方法:<span style="font-size: 9pt; line-height: 13.6px;">（对未对齐的部分会进行Nan填充，直接相加是不会进行填充的）</span></span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">ser_obj3 = ser_obj1.add(ser_obj2, [fill_value=0.])</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">参数</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">fill_value:  表示提供一个数据进行未对齐的运算（不是填充到运算结果里面）</span></font></div></li></ul></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">示例</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [28].png" type="image/png" data-filename="Image.png" width="387"/></span></div></li></ul></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">DataFrame数据间的对齐运算操作</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">方法</span><span style="font-size: 9pt; line-height: 13.6px;">（对未对齐的部分会进行Nan填充，直接相加是不会进行填充的）</span></font></div></li><ul><li><div><span style="font-size: 9pt;">df_obj4 = df_obj1.add(df_obj2, [fill_value=0.])</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">参数</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">fill_value:  表示提供一个数据进行未对齐的运算（不是填充到运算结果里面）</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">备注：</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">当存在运算的两个数据都不存在某索引的情况，即使给出fill_value参数结果还会是NaN</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">示例</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [29].png" type="image/png" data-filename="Image.png" width="352"/></span></div></li></ul></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">DataFrame 和 Series 之间对齐运算</span></font></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">方法</span></div></li><ul><li><div><span style="font-size: 9pt;">df_obj1.add(ser_obj1, axis = 0)</span></div></li><ul><li><div><span style="font-size: 9pt;">axis：可以通过axis参数指定Series的运算方向， axis = 0 将Series看成一列多行， axis = 1 将Series看成一行多列</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">示例</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Padas的索引查询操作对齐运算_files/Image [30].png" type="image/png" data-filename="Image.png" width="270"/></span></div></li></ul></ul></ul></div><div><br/></div></span>
</div></body></html>