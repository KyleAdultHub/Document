---
title: Pandas的数据结构和基础操作
date: "2017-05-23 20:00:00"
categories:
- 机器学习
- Numpy、Pandas
tags:
- 数据处理
- pandas
toc: true
typora-root-url: ..\..\..
---

<html>
<body>
<div>
<span><div><font style="font-size: 14pt;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">什么是Pandas</span></font></div><div><ul><li><div><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">Pandas的介绍</span></span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 1.45;">Pandas的名称来自于面板数据（panel data）和Python数据分析（data analysis）。</span></div></li><li><div><span style="font-size: 9pt;">Pandas是一个强大的分析结构化数据的工具集，基于NumPy构建，提供了 高级数据结构 和 数据操作工具，它是使Python成为强大而高效的数据分析环境的重要因素之一。</span></div></li></ul><li><div><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.6px;">Pandas的作用</span></span></div></li><ul><li><div><span style="font-size: 9pt;">一个强大的分析和操作大型结构化数据集所需的工具集</span></div></li><li><div><span style="font-size: 9pt;">基础是NumPy，提供了高性能矩阵的运算</span></div></li><li><div><span style="font-size: 9pt;">提供了大量能够快速便捷地处理数据的函数和方法</span></div></li><li><div><span style="font-size: 9pt;">应用于数据挖掘，数据分析</span></div></li><li><div><span style="font-size: 9pt;">提供数据清洗功能</span></div></li></ul><li><div><font style="font-size: 12px;"><span style="font-size: 12px; font-weight: bold; line-height: 13.6px;">Pandas的导包形式</span></font></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">import pandas as pd</span></div></li></ul><li><div><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">Pandas文档</span></span></div></li><ul><li><div><a href="http://pandas.pydata.org/" style="font-size: 9pt;">http://pandas.pydata.org</a></div></li></ul></ul></div><div><font style="background-color: rgb(255, 250, 165);font-size: 14pt;-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Pandas的数据结构</span></font></div><div><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Pandas最主要也是最重要的两个数据结构</span></font></div></li><ul><li><div><span style="font-size: 9pt;">Series和DataFrame</span></div></li></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">Pandas-Series数据结构</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.6px;">Series数据结构的介绍</span></font></div></li><ul><li><div><span style="font-size: 9pt;">Series是一种类似于一维数组的 对象，由一组数据（各种NumPy数据类型）以及一组与之对应的索引（数据标签）组成。</span></div></li><li><div><span style="font-size: 9pt;">类似一维数组对象</span></div></li><li><div><span style="font-size: 9pt;">由数据和索引组成</span></div></li><ul><li><div><span style="font-size: 9pt;">索引(index)在左，数据(values)在右</span></div></li><li><div><span style="font-size: 9pt;">索引是自动创建的</span></div></li><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image.png" type="image/png" data-filename="Image.png" width="136"/></span></div></li></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">Series数据结构的基本操作</span></font></div></li><ul><li><div><span style="font-size: 9pt;">Series数据 结构的创建</span></div></li><ul><li><div><span style="font-size: 9pt;">通过列表或者range()函数来创建Series，索引类型为从零开始以一为步长递增</span></div></li><ul><li><div><span style="font-size: 9pt;">ser_obj = pd.Series(range(10))</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">通过ndarray来创建Series，索引默认为从零开始以一为步长递增</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj = pd.Series(arr)   </span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">arr 为一维ndarry数组</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">通过dict来构建Series，字典的键对应索引</span></div></li><ul><li><div><span style="font-size: 9pt;">ser_obj2 = pd.Series(dict</span><span style="font-size: 9pt; line-height: 1.45;">)</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">创建的时候指定索引,注意索引数量和值的数量相等</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj = pd.Series(range(10, 15), index=list('abcde'))</span></div></li></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">通过索引来获取数据（后面有详细通过索引对数据进行查询的方法）</span></font></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj[idx]</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">name属性</span></div></li><ul><li><div><span style="font-size: 9pt;">定义Series对象名：ser_obj.name</span></div></li><li><div><span style="font-size: 9pt;">定义Series对象索引名：ser_obj.index.name</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">查看前几行的数据</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj.head(x)</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">x 代表 查看前多少行的数据，默认为查看所有行的数据</span></font></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">删除行数据</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">第一种方法(不会修改原数据)</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj</span><span style="font-size: 9pt; line-height: 13.6px;">.drop([index1, index2, ...])</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">第二种方法（会在原数据的基础上进行删除）</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">del(</span><span style="font-size: 9pt; line-height: 13.6px;">ser_obj[index]</span><span style="font-size: 9pt; line-height: 13.6px;">)</span></font></div></li></ul></ul><li><div><span style="font-size: 9pt;">Series获取数据和索引</span></div></li><ul><li><div><span style="font-size: 9pt;">索引的获取</span></div></li><ul><li><div><span style="font-size: 9pt;">ser_obj.index    返回Series的索引对象</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">索引对象的转化</span></div></li><ul><li><div><img src="/e_img/Pandas的数据结构和基础操作_files/Image [1].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="215"/></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">数据的获取</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj.values    返回一个一维ndarray</span></div></li></ul></ul></ul></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;"> Pandas-DataFrame数据结构</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.6px;">DataFrame数据结构的介绍</span></font></div></li><ul><li><div><span style="font-size: 9pt;">DataFrame是一个表格型的数据结构，每一列的数据都是有序的，不同列之间的数据类型可以不相同。</span></div></li><li><div><span style="font-size: 9pt;">DataFrame既有行索引也有列索引，它可以被看做是由多个Series组成的字典（共用行索引），数据是以二维结构存放的。</span></div></li><li><div><span style="font-size: 9pt;">类似多维数组/表格数据 (如，excel, R中的data.frame)</span></div></li><li><div><span style="font-size: 9pt;">每列数据可以是不同的类型</span></div></li><li><div><span style="font-size: 9pt;">索引包括列索引和行索引</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [2].png" type="image/png" data-filename="Image.png" width="222"/></span></div></li></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">DataFrame数据结构的基本操作</span></font></div></li><ul><li><div><span style="font-size: 9pt;">DataFrame结构的创建</span></div></li><ul><li><div><span style="font-size: 9pt;">通过ndarray创建DataFrame，行列索引都是从0开始以一不步长递增 </span></div></li><ul><li><div><span style="font-size: 9pt;">df_obj = pd.DataFrame(array)</span></div></li><ul><li><div><span style="font-size: 9pt;">array 为numpy的数组对象</span></div></li></ul></ul><li><div><span style="font-size: 9pt;">通过dict创建DataFrame，字典的键为列索引 ，值为每一列的所有数据</span></div></li><ul><li><div><span style="font-size: 9pt;">df_obj = pd.DataFrame(dict_data)</span></div></li><ul><li><div><span style="font-size: 9pt;">dict_data为python的字典类型数据，每个键对应的数据类型可以不一致</span></div></li></ul><li><div><span style="font-size: 9pt;">示例</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [3].png" type="image/png" data-filename="Image.png" width="320"/></span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">创建DataFrame同时指定行索引</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">df_obj = pd.DataFrame(arr, index=list('abc'), colums=list('abcd'))</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">index:  指定的行索引</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">colums：指定的列索引</span></div></li></ul></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">通过列索引获取数据-返回的数据为series类型</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">第一种方法</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">df_obj[col_idx]</span></font></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">第二种方法</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">df_obj.col_idx</span></font></div></li></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">示例</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [4].png" type="image/png" data-filename="Image.png" style="line-height: 1.45;" width="149"/></span></div></li></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">增加列数据</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">df_obj[new_col_idx] = data    类似于Python的dict添加key-value</span></font></div></li><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">示例</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [5].png" type="image/png" data-filename="Image.png" style="line-height: 1.45;" width="159"/></span></div></li></ul></ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">删除列数据</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">del(</span><span style="font-size: 9pt; line-height: 1.45;">df_obj[col_idx]</span><span style="font-size: 9pt; line-height: 1.45;">)</span></font></div></li><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">示例</span></font></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [6].png" type="image/png" data-filename="Image.png" style="line-height: 1.45;" width="138"/></span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">删除行或列数据（不会修改原数据）</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">df_obj.drop([index1, index2, ...], axis = 0)</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">axis: 0表示删除每一列中的指定行数据，1表示删除每行的某些列</span></div></li></ul></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">查看前几行的数据</span></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">df_obj</span><span style="font-size: 9pt; line-height: 13.6px;">.head(x)</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">x 代表 查看前多少行的数据，默认为查看所</span><span style="font-size: 9pt; line-height: 13.6px;">有行的数据</span></font></div></li></ul></ul><li><div><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.6px;">DataFrame设置行索引</span></font></div></li><ul><li><div><span style="font-size: 9pt;">DataFrame.set_index(keys, drop=True, append=False, inplace=False) </span></div></li><ul><li><div><span style="line-height: 13.6px;">keys：列表，表示设置为索引的列，列表中包含 多个值，表示设置联合索引</span></div></li><li><div><span style="font-size: 9pt;">append：添加新索引</span></div></li><li><div><span style="font-size: 9pt;">drop：True表示将该列作为索引后，数据列将会丢弃</span></div></li><li><div><span style="font-size: 9pt;">inplace：True表示在原数据上进行修改</span></div></li></ul></ul><li><div><span style="font-size: 9pt;">DataFrame还原行索引（将行索引还原为普通数字索引，并将索引还原为数据列）</span></div></li><ul><li><div><span style="font-size: 9pt;">DataFrame.reset_index(level=None, drop=False, inplace=False) </span></div></li><ul><li><div><span style="font-size: 9pt;">level：表示具体要还原的哪个等级的索引 </span></div></li><li><div><span style="font-size: 9pt;">drop：False表示索引列会被还原为普通列，否则会丢失</span></div></li><li><div><span style="font-size: 9pt;">inplace：True表示在原数据上进行修改</span></div></li></ul></ul><li><div><span style="font-size: 9pt;">DataFrame获取数据和索引</span></div></li><ul><li><div><span style="font-size: 9pt;">行索引的获取</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 1.45;">df_obj</span><span style="font-size: 9pt;">.index    返回行索引对象</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">列索引的获取</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 1.45;">df_obj.columns   返回列索引对象</span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">索引对象的转化</span></div></li><ul><li><div><span style="font-size: 9pt;"><img src="/e_img/Pandas的数据结构和基础操作_files/Image [7].png" type="image/png" data-filename="Image.png" width="222"/></span></div></li></ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">数据的获取</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">ser_obj.values    返回一个多维ndarray</span></div></li></ul></ul><li><div><span style="line-height: 13.6px;">重命名列名</span></div></li><ul><li><div><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.6px;">df_obj.rename(columns={</span><span style="font-size: 12px; line-height: 13.6px;">'old_key': 'new_key'</span><span style="font-size: 12px; line-height: 13.6px;">}, [inplace=True])</span></font></div></li><ul><li><div><font style="font-size: 12px;"><span style="font-size: 12px; line-height: 13.6px;">将old_key一列的列名，改为new_key</span></font></div></li><li><div><span style="font-size: 12px; line-height: 13.6px;">inplace: True在原数据的基础上进行修改，False会返回新的修改后的数据，默认为False</span></div></li></ul></ul></ul></ul></ul><div><font style="font-size: 14pt;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165); color: rgb(50, 135, 18); font-weight: bold; line-height: 13.6px;-evernote-highlight:true;">使用pandas读写文件</span></span></font></div></div><div><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">读取csv文件数据的方法</span></font></div></li><ul><li><div><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.6px;">df_obj = pd.read_csv('filename', [<span style="font-size: 9pt; line-height: 13.6px;">usecols=['col1', 'col2'], skiprows=n1, skipfooter=n2, index_col=n3, engine='python'</span></span><span style="font-size: 9pt; line-height: 13.6px;">])     返回的是DataFrame对象</span></font></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">filename：表示读取的文件名</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">usecols：表示读取文件的哪些列</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">skiprows:  表示跳过文件的前几行</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">skipfooter： 表示跳过文件的后几行</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">index_col：表示使用那一列作为索引列</span></div></li><li><div><span style="font-size: 9pt; line-height: 13.6px;">engine： 使用的解释器引擎， 当读取中文文件的时候需要指定</span></div></li></ul></ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.6px;">写入csv数据的方法</span></font></div></li><ul><li><div><span style="font-size: 9pt;">df_obj.to_csv(&quot;filename&quot;)</span></div></li><ul><li><div><span style="font-size: 9pt; line-height: 13.6px;">filename：表示读取的文件名,要加上.csv后缀；</span></div></li></ul></ul><li><div><span style="font-weight: bold; font-size: 10pt;">读取excel的方法</span></div></li><ul><li><div>data_frame = pd.read_excel(report_path, sheet_name=sheet_name, skiprows=skiprows, index_col=index_col, usecols=usecols)</div></li><ul><li><div><span style="font-size: 9pt;">report_path: 读取的文件路径</span></div></li><li><div><span style="font-size: 9pt;">sheet_name: 读取的sheet名称，不指定默认读取第一个sheet</span></div></li><li><div><span style="font-size: 9pt;">skiprows: 跳过前面的几行， 读取的结果会将包含内容的第一行作为索引行</span></div></li><li><div><span style="font-size: 9pt;">index_col: 指定某列当做索引列</span></div></li><li><div><span style="font-size: 9pt;">use_cols: 使用A, B,C ... 拼接的字符串</span></div></li></ul></ul><li><div><span style="font-size: 10pt; font-weight: bold;">写入excel的方法</span></div></li><ul><li><div><span style="font-size: 9pt;">excel_writer = pd.ExcelWriter(save_path, engine='openpyxl')</span></div></li><li><div><span style="font-size: 9pt;">dataframe.to_excel(excel_writer=excel_writer, sheet_name=sheet, index=False)</span></div></li><ul><li><div>sheet = sexcel_writer.book.worksheets[sheet_index]</div></li><li><div>sheet.column_dimensions[column_dimension_list[index]].width = size</div></li><li><div><span style="font-size: 9pt;">excel_writer.save()</span></div></li><li><div><span style="font-size: 9pt;">excel_writer.close()</span></div></li></ul></ul></ul><div><br style="font-size: 9pt;"/></div></div><div><br/></div></span>
</div></body></html>