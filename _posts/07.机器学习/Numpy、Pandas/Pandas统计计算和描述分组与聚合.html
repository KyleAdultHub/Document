---
title: Pandas统计计算和描述分组与聚合
date: "2017-05-24 23:00:00"
categories:
- 机器学习
- Numpy、Pandas
tags:
- 数据处理
- pandas
toc: true
typora-root-url: ..\..\..
---

<html>
<body>
<div>
<span><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Pandas统计计算和描述</span></span></div><div><ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">Pandas常用的统计计算和统计描述方法</span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image.png" type="image/png" data-filename="Image.png" width="363"/></span></li></ul><li><span style="font-size: 10pt; font-weight: bold;">Pandas统计计算</span></li><ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold;">常用的统计计算</span></span></li><ul><li><span style="font-size: 9pt;">sum, mean, max, min…</span></li></ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">使用方法（以sum来举例）</span></span></li><ul><li><span style="font-size: 9pt;">df_obj.sum()   </span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">参数</span></li><ul><li><span style="font-size: 9pt;">axis=0 按列统计，axis=1按行统计，默认按照列来统计</span></li><li><span style="font-size: 9pt;">skipna 排除缺失值， 默认为True,False时，Nan会参与运算，不会被忽略</span></li></ul></ul></ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">示例代码：</span></span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [1].png" type="image/png" data-filename="Image.png" width="333"/></span></li></ul></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">Pandas统计描述</span></li><ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">使用方法</span></span></li><ul><li><span style="font-size: 9pt;">describe()     产生每列的多个类型统计数据</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">参数</span></li><ul><li><span style="font-size: 9pt;">axis=0 按列统计，axis=1按行统计<span style="font-size: 9pt;">，默认按照列来统计</span></span></li><li><span style="font-size: 9pt;">skipna 排除缺失值， 默认为True,False时，Nan会参与运算，不会被忽略</span></li></ul></ul></ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">示例代码</span></span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [2].png" type="image/png" data-filename="Image.png" width="240"/></span></li></ul></ul></ul></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">Pandas分组与聚合</span></span></div><div><div><span style="font-size: 14pt; font-weight: bold; line-height: 1.45;">Pandas的分组</span></div><ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">Pandas分组的介绍</span></li><ul><li><span style="line-height: 1.45; font-size: 9pt;">对数据集进行分组，然后对每组进行统计分析</span></li><li><span style="line-height: 1.45; font-size: 9pt;">SQL能够对数据进行过滤，分组聚合</span></li><li><span style="line-height: 1.45; font-size: 9pt;">pandas能利用groupby进行更加复杂的分组运算</span></li><li><span style="line-height: 1.45; font-size: 9pt;">分组运算过程：split-&gt;apply-&gt;combine</span></li><ul><li><span style="line-height: 1.45; font-size: 9pt;">拆分：进行分组的根据</span></li><li><span style="line-height: 1.45; font-size: 9pt;">应用：每个分组运行的计算规则</span></li><li><span style="line-height: 1.45; font-size: 9pt;">合并：把每个分组的计算结果合并起来</span></li></ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [3].png" type="image/png" data-filename="Image.png" style="line-height: 1.45;" width="329"/></span></li></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">GroupBy对象分组操作（分组类型：DataFrameGroupBy，SeriesGroupBy）</span></li><ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">对数据进行分组</span></span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">对数据进行分组（基本操作）</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">groupby(lable)          对数据进行分组，返回一个GroupBy对象</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">lable：分组的依据，例如df_obj['key1'],按照df_obj的key1列进行分组</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [4].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="347"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 1.45;">对应整个数据集的指定列进行分组</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">分组方法</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">df_obj.groupby(df_obj['key'])</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">代码示例</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [5].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="224"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 1.45;">对指定的列进行分组</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">分组方法</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">df_obj['data1'].groupby(df_obj['key1'])</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">代码示例</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [6].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="272"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 1.45;">对整个数据集，对指定多个分组依据进行分组</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">分组方法</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">df_obj.groupby([df_obj['key1'], df_obj['key2']])</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">  </span><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [7].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="355"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 1.45;">对指定的列，多个分组依据进行分组</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">分组方法</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">df_obj[ ['data1', 'data2'] ].groupby([df_obj['key1'], df_obj['key2']])</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [8].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="395"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">按照自定义key进行分组</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">自定义分组依据</span><span style="font-size: 9pt; line-height: 13.600000381469727px;">，保证和数据集的行数量一致</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">self_key = ['key1', 'key2', 'key3', 'key4'，'key1', 'key2']</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">当两行数据的分组依据相同时，被分为同一组</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">将数据进行自定义分组</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">df_obj.groupby(self_key).sum()</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">代码示例</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [9].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="264"/></li></ul></ul><li><span style="font-size: 9pt; line-height: 1.45;">按照数据类型进行分组</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [10].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="306"/></li></ul></ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">其他分组方法</span></span></li><ul><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [11].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="375"/></li></ul><li><span style="font-size: 9pt; line-height: 1.45;">通过字典来进行分组</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [12].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="315"/></li></ul><li><span style="font-size: 9pt; line-height: 1.45;">通过函数进行分组</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [13].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="364"/></li></ul><li><span style="font-size: 9pt; line-height: 1.45;">通过索引进行分组</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [14].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="426"/></li></ul></ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">对分组后的数据进行运算（后面的聚合操作，这里只做简单演示）</span></span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法(假定已分组的数据为grouped)</span></li><ul><li><span style="font-size: 9pt; line-height: 1.45;">grouped.sum()    对分组后的数据，每组进行运算</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">支持的运算方法包括pandas支持的统计运算方法，sum\mean\count等</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [15].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="346"/></li></ul></ul></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">GroupBy对象的基本操作</span></li><ul><li><span style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">GroupBy对象的迭代操作</span></span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">GroupBy可迭代对象</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">GroupBy是一个可迭代的对象</span></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">每次迭代返回一个元组 (group_name, group_data)，</span><span style="font-size: 9pt; line-height: 1.45;">可用于分组数据的具体运算</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">单层分组的迭代</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [16].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="383"/></li></ul><li><span style="font-size: 9pt; line-height: 1.45;">多层分组的迭代</span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [17].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="305"/></li></ul></ul><li><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">G</span><span style="font-weight: bold; line-height: 1.45;"><font style="font-size: 9pt;">roupBy对象转化为字典或列表</font></span></li><ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">将GroupBy对象转化为列表</font></span></li><ul><li><span style="line-height: 1.45;"><font style="font-size: 9pt;">list(grouped1)</font></span></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">将GroupBy对象转化为字典</font></span></li><ul><li><span style="line-height: 1.45;"><font style="font-size: 9pt;">dict(list(grouped1))</font></span></li></ul><li><span style="line-height: 13.600000381469727px;"><font style="font-size: 9pt;">代码示例</font></span></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [18].png" type="image/png" data-filename="Image.png" style="font-size: 9pt; line-height: 1.45;" width="359"/></li></ul></ul></ul></ul><div><span style="font-size: 14pt; font-weight: bold; line-height: 1.45;">Pandas的聚合</span></div></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Pandas聚合的介绍</span></font></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 1.45;">常用于对分组后的数据进行计算，求平均数，计算总数量等。</span></font></li></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">常用内置聚合函数</span></font></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [19].png" type="image/png" data-filename="Image.png" width="246"/></span></li></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">内置聚合函数</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">常用的内置聚合函数</span></li><ul><li><span style="font-size: 9pt;">sum(), mean(), max(), min(), count(), size(), describe()</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用内置聚合函数的方法(以sum为例子)</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped.sum()</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped为分组后的对象</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [20].png" type="image/png" data-filename="Image.png" width="544"/></span></li></ul></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">使用自定义聚合函数（单个）</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法</span></li><ul><li><span style="font-size: 9pt;">grouped.agg(func)</span><span style="font-size: 9pt; line-height: 13.600000381469727px;">.add_prefix('sum_')</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped：对Pandas分组后的对象</span></font></li><li><span style="font-size: 9pt;">func：是自定义的聚合函数，其参数为分组后的对象grouped的数据部分</span></li><li><span style="font-size: 9pt;">.add_prefix()   表示给聚合运算后的列名添加一个前缀</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [21].png" type="image/png" data-filename="Image.png" width="176"/></span></li></ul></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">同时对多个列应用多个聚合函数</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped.agg(['sum', 'mean', func]).add_prefix('sum_')</span></font></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped: 为分组后的对象</span></font></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">在agg中传入列表，其中包含所有想要使用的聚合函数名</span></li><li><span style="font-size: 9pt;">.add_prefix()   表示给聚合运算后的列名添加一个前缀</span></li></ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">给聚合后的结果起别名</span></font></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">grouped.agg([('总和'，</span> <span style="font-size: 9pt; line-height: 13.600000381469727px;">'sum'</span><span style="font-size: 9pt; line-height: 13.600000381469727px;">), （'平均数', mean）,  （'max-min', func）])</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">('max-min', func):  前面的参数表示给聚合函数其一个别名，在显示的时候会显示别名</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [22].png" type="image/png" data-filename="Image.png" width="458"/></span></li></ul></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold; line-height: 13.600000381469727px;">对不同列分别作用不同的聚合函数，使用dict</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">使用方法</span></li><ul><li><span style="font-size: 9pt;">dict_obj = { 'data1': 'mean', 'data2': 'sum' }</span></li><li><span style="font-size: 9pt;">grouped.agg(dict_obj).add_prefix('sum_')</span></li><ul><li><span style="font-size: 9pt;">grouped：是分组后的对象</span></li><li><span style="font-size: 9pt;">dict_obj: 用来表示pandas分组后每个字段用什么聚合函数来统计计算</span></li><li><span style="font-size: 9pt;">.add_prefix('sum_')   表示给聚合运算后的列名添加一个前缀</span></li></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">给聚合后的结果起别名</span></li><ul><li><span style="font-size: 9pt;">dict_obj = { 'data1': [('平均数'，'mean'), ('和', 'sum')]}</span></li><li><span style="font-size: 9pt;">grouped.agg(dict_obj)</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">示例代码</span></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [23].png" type="image/png" data-filename="Image.png" width="388"/></span></li></ul></ul></ul><div><font style="background-color: rgb(255, 250, 165); font-size: 14pt;-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 14pt; color: rgb(50, 135, 18); font-weight: bold;-evernote-highlight:true;">分组聚合后的多表连接</span></font></div></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">作用</span></font></li><ul><li><span style="font-size: 9pt;">将DataFrame进行分组和聚合运算后，生成的对象是另外一个DataFrame对象</span></li><li><span style="font-size: 9pt;">如果想要将两张表的数据集合到一张表上，可以使用夺标连接的方法将多张表进行合并</span></li></ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">先定义两张表（一个是原始数据表，一个是经过分组、聚合运算过后的表）</span></font></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [24].png" type="image/png" data-filename="Image.png" width="398"/></span></li></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">merge多表联接</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">使用方法（将会生成一个新的关联后的表，默认会给生成新表若有重复列名，会给列名添加x,y的后缀）</span></font></li><ul><li><span style="font-size: 9pt;">key1_sum_merge = pd.merge(df_obj, key1_sum, left_on='key1', right_index=True)</span></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">df_obj,key1_sum: 分别表示左表和右表</span></li><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">left_on/right_on:  表示左/右表的列作为连接键</span></font></li><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">right_index/left_index:  True表示使用左/右表的行索引作为连接键</span></font></li></ul></ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">示例代码</span></font></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [25].png" type="image/png" data-filename="Image.png" width="434"/></span></li></ul></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">transform多表联接（接收聚合函数进行运算，并将运算结果和原数据保持一致，可直接和原表进行联表操作）</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">使用方法</span></font></li><ul><li><span style="line-height: 13.600000381469727px; font-size: 9pt;">第一步：生成聚合后的对象</span></li><ul><li><span style="font-size: 9pt;">new_obj = grouped.transform(&quot;sum&quot;).add_prefix(&quot;sum_&quot;)</span></li><ul><li><span style="line-height: 13.600000381469727px; font-size: 9pt;">grouped：表示分组后的对象</span></li><li><span style="font-size: 9pt;">add_prefix(&quot;sum_&quot;)： 给聚合生成的列名添加前缀</span></li></ul></ul><li><span style="line-height: 13.600000381469727px; font-size: 9pt;">第二步：将两个表进行联接(将聚合运算后的列添加的原数据中)</span></li><ul><li><span style="font-size: 9pt;">orign_obj[new_obj.columns] = new_obj</span></li></ul></ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 1.45;">示例代码</span></font></li><ul><li><span style="font-size: 9pt;"><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [26].png" type="image/png" data-filename="Image.png" width="444"/></span></li></ul></ul><li><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">grouped.apply(func)多组数据合并    （分组后，将各组数据分别应用自定义的func，并自行合并成一组数据）</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">使用方法</span></font></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">第一步：定义自定义函数（也可以是匿名函数</span><span style="font-size: 9pt; line-height: 13.600000381469727px;">）</span></font></li><ul><li><span style="font-size: 9pt;">def func(df, n=n1, col=n2):</span></li><ul><li><span style="font-size: 9pt;">return df.sort_values(by=col, ascending=False)[:n]</span></li></ul></ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">第二步：对数据进行分组，并使用applay将数据应用到自定义的func上</span></li><ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; line-height: 13.600000381469727px;">df_obj.groupby(df_obj['col_name'],  [group_keys=False]).apply(func， [n1, n2])</span></font></li><ul><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">func:  自定义的函数，接收的第一个参数为分组后的对象</span></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">n2, n2: 是传递给func函数其他的参数</span></li><li><span style="font-size: 9pt; line-height: 13.600000381469727px;">group_keys:  在使用apply时有时候会产生层级索引(外层索引是分组名，内层索引是df_obj的行索引)，当设置为False可以禁用</span></li></ul></ul></ul><li><font style="font-size: 9pt;"><span style="font-size: 9pt; font-weight: bold; line-height: 13.600000381469727px;">示例代码</span></font></li><ul><li><img src="/e_img/Pandas统计计算和描述分组与聚合_files/Image [27].png" type="image/png" data-filename="Image.png" style="font-size: 9pt;" width="355"/></li></ul></ul></ul><div><br/></div></div><div><br/></div></span>
</div></body></html>