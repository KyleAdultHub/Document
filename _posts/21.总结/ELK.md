---
title: ELK
date: "2020-04-24 11:23:11"
categories:
- 总结
tags:
- 总结
toc: true
typora-root-url: ..\..\..
---

1. ES(分布式全文检索引擎) 怎么解决大数据的写入和查询瓶颈的

    - 存储数据时按照有序存储
    - 将数据和索引分离
    - 对存储数据进行压缩

2. ES 与 Lucence 的关系
    1）Lucene只是一个库。想要使用它，你必须使用Java来作为开发语言并将其直接集成到你的应用中，更糟糕的是，Lucene非常复杂，你需要深入了解检索的相关知识来理解它是如何工作的。

    2）Elasticsearch也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。


3. ES核心概念
    1）Cluster: 集群。ES可以作为一个独立的单个搜索服务器。不过，为了处理大型数据集，实现容错和高可用性，ES可以运行在许多互相合作的服务器上。这些服务器的集合称为集群。
    
    2）Node: 节点。形成集群的每个服务器称为节点。
    
    3）Index: 索引。index是一系列document 的集合。比方说我们可以有一个index叫做 customer data，另外一个叫做product catalog，还有一个叫做 order data。一个index被一个唯一的小写字母名字标记。这个名字将会影响里面数据的查询，更新操作
    
    4）Type: 分组。在一个Index中，我们可以定义很多的type。一个type是一个逻辑分组。大多数情况下，同一个type中的数据会有相同的数据结构。
    
    5）Document: 记录。一个Document是一个可以被索引的基本单元。

    6）Shard: 分片。当有大量的文档时，由于内存的限制、磁盘处理能力不足、无法足够快的响应客户端的请求等，一个节点可能不够。这种情况下，数据可以分为较小的分片。每个分片放到不同的服务器上。当你查询的索引分布在多个分片上时，ES会把查询发送给每个相关的分片，并将结果组合在一起，而应用程序并不知道分片的存在。即：这个过程对用户来说是透明的。
    
    7）Replia: 副本。为提高查询吞吐量或实现高可用性，可以使用分片副本。副本是一个分片的精确复制，每个分片可以有零个或多个副本。ES中可以有许多相同的分片，其中之一被选择更改索引操作，这种特殊的分片称为主分片。当主分片丢失时，如：该分片所在的数据不可用时，集群将副本提升为新的主分片。
    
    8）全文检索: 全文检索就是对一篇文章进行索引，可以根据关键字搜索，类似于mysql里的like语句。全文索引就是把内容根据词的意义进行分词，然后分别创建索引，例如”你们的激情是因为什么事情来的” 可能会被分词成：“你们“，”激情“，“什么事情“，”来“ 等token，这样当你搜索“你们” 或者 “激情” 都会把这句搜出来。

4. Es数据架构和Mysql对比
    |  mysql        |   Elastic Search      |
    |  Database     |   Index      |
    |  Table        |   Type      |
    |  Row        |   Document      |
    |  Column        |   Field      |
    |  Schema        |   Mapping(定义索引如果建立如何使用)      |
    |  Index        |   Everything is indexed      |

5. Es 的特点和优势
    1）分布式实时文件存储，可将每一个字段存入索引，使其可以被检索到。
    2）实时分析的分布式搜索引擎。
    分布式：索引分拆成多个分片，每个分片可有零个或多个副本。集群中的每个数据节点都可承载一个或多个分片，并且协调和处理各种操作；
    负载再平衡和路由在大多数情况下自动完成。
    3）可以扩展到上百台服务器，处理PB级别的结构化或非结构化数据。也可以运行在单台PC上（已测试）
    4）支持插件机制，分词插件、同步插件、Hadoop插件、可视化插件等。

6. Es 的节点角色
    1）master node
        主要功能：维护元数据，管理集群节点状态；不负责数据写入和查询。
        配置要点：内存可以相对小一些，但是机器一定要稳定，最好是独占的机器。
    2）client node
        主要功能：负责任务分发和结果汇聚，分担数据节点压力。
        配置要点：大内存，最好是独占的机器
    3）data node
        主要功能：负责数据的写入与查询，压力大。
        配置要点：大内存，最好是独占的机器。
    3）mixed node
        主要功能：综合上述三个节点的功能。
        配置要点：大内存，最好是独占的机器。

7. Es 过滤器
    - term: 精确过滤
    - terms: 多次条匹配
    - range: 范围过滤
    - exists: 存在某些条件
    - missing: 不存在某些条件
    - ids: 指定多个id过滤器
    - bool 过滤器; must, or, and 过滤器